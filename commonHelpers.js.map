{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["'use strict';\n\nimport axios from 'axios';\nexport class ImagesAPI {\n  constructor(userSearchRequest, page) {\n    this.BASE_URL = 'https://pixabay.com';\n    this.ENDPOINT = '/api/';\n\n    this.PARAMS = {\n      key: '42471766-4e6ef41ee0191e88bcacb27c7',\n      q: userSearchRequest,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: 'true',\n      page: page,\n      per_page: 15,\n    };\n\n    this.URL = `${this.BASE_URL}${this.ENDPOINT}`;\n  }\n\n  async getImages() {\n    try {\n      const response = await axios.get(this.URL, { params: this.PARAMS });\n      return response.data;\n    } catch (error) {\n      console.log(error.message);\n    }\n  }\n}\n","'use strict';\n\nconst gallery = document.querySelector('.gallery');\n\nexport function templateImage(image) {\n  return `<li class=\"gallery-card\">\n  <div class=\"gallery-card-wrapper\">\n    <div class=\"thumb\">\n      <a href=\"${image.largeImageURL}\" class=\"gallery-link-image\"><img class=\"gallery-img\" src=\"${image.webformatURL}\" data-original-size=\"${image.largeImageURL}\" alt=\"${image.tags}\" /></a>\n    </div>\n    <ul class=\"statistic-list\">\n      <li class=\"statistic-item\">\n        <p class=\"statistic-name\">Likes</p>\n        <p class=\"statistic-numbers\">${image.likes}</p>\n      </li>\n      <li class=\"statistic-item\">\n        <p class=\"statistic-name\">Views</p>\n        <p class=\"statistic-numbers\">${image.views}</p>\n      </li>\n      <li class=\"statistic-item\">\n        <p class=\"statistic-name\">Comments</p>\n        <p class=\"statistic-numbers\">${image.comments}</p>\n      </li>\n      <li class=\"statistic-item\">\n        <p class=\"statistic-name\">Downloads</p>\n        <p class=\"statistic-numbers\">${image.downloads}</p>\n      </li>\n    </ul>\n  </div>\n</li>`;\n}\n\nexport function createMarkup(images) {\n  const elementMarkup = images.map(image => templateImage(image));\n  const markup = elementMarkup.join('');\n  markupRender(markup);\n}\n\nexport function markupRender(markup) {\n  gallery.insertAdjacentHTML('beforeend', markup);\n}\n\n","'use strict';\n\nimport { ImagesAPI } from './js/pixabay-api';\nimport * as renderFunctions from './js/render-functions';\n\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nimport axios from 'axios';\n\nconst izitoastMessageOptions = {\n  message: 'The search field must be filled!',\n  messageColor: 'white',\n  backgroundColor: 'red',\n  close: false,\n  position: 'topRight',\n  progressBar: false,\n  animateInside: false,\n  timeout: 3000,\n};\n\nconst refs = {\n  form: document.querySelector('.form'),\n  inputSearch: document.querySelector('[type=\"search\"]'),\n  searchButton: document.querySelector('[type=\"submit\"]'),\n  gallery: document.querySelector('.gallery'),\n  loader: document.querySelector('.loader'),\n  loadButton: document.querySelector('.btn-load-more'),\n};\n\nrefs.form.addEventListener('submit', fetchOnPixabayAPI);\nrefs.loadButton.addEventListener('click', loadMoreImages);\n\nlet page = 1;\nlet userValue;\nlet isTheSame;\n\nfunction fetchOnPixabayAPI(evt) {\n  evt.preventDefault();\n  refs.loader.classList.remove('hidden');\n\n  const userSearchWords = refs.inputSearch.value.trim(); // валідація даних, які ввів користувач\n  const userSearchParams = userSearchWords.split(' ').join('+'); // валідація даних, які ввів користувач\n\n  if (userSearchWords === '') {\n    refs.loader.classList.add('hidden'); // перевірка на порожній рядок.\n    iziToast.show(izitoastMessageOptions);\n    return;\n  }\n\n  isTheSame = isTheUserValueTheSame(userSearchParams); // Якщо значення користувача теж саме, функція поверне true, в іншому випадку false.\n\n  if (!isTheSame) {\n    refs.loadButton.classList.add('hidden'); // перевірка, чи значення користувача інше.\n    refs.gallery.innerHTML = '';\n    page = 1;\n  }\n\n  const imagesApi = new ImagesAPI(userSearchParams);\n  refs.form.reset();\n\n  imagesApi\n    .getImages()\n    .then(respData => {\n      checkTheSearchResults(respData.hits);\n\n      if (!(respData.totalHits < 15)) {\n        userValue = userSearchParams;\n        checkQuantityOfElements(respData.totalHits);\n      }\n\n      userValue = userSearchParams;\n    })\n    .catch(error =>\n      iziToast.show({ ...izitoastMessageOptions, message: 'Bad request' })\n    )\n    .finally(() => {\n      refs.loader.classList.add('hidden');\n    });\n}\n\nfunction checkQuantityOfElements(totalQuantity) {\n  const pagesQuantity = Math.ceil(totalQuantity / 15);\n\n  console.log(totalQuantity);\n\n  if (page <= pagesQuantity) {\n    refs.loadButton.classList.remove('hidden');\n  } else {\n    refs.loadButton.classList.add('hidden');\n    iziToast.show({\n      ...izitoastMessageOptions,\n      message: `We're sorry, but you've reached the end of search results.`,\n      backgroundColor: 'blue',\n    });\n  }\n}\n\nfunction loadMoreImages() {\n  refs.loadButton.classList.add('hidden');\n  refs.loader.classList.remove('hidden');\n  refs.loader.classList.toggle('under-btn');\n\n  page += 1;\n  const imagesAPI = new ImagesAPI(userValue, page);\n\n  imagesAPI.getImages().then(respData => {\n    checkTheSearchResults(respData.hits);\n\n    checkQuantityOfElements(respData.totalHits);\n\n    refs.loader.classList.add('hidden');\n    refs.loader.classList.toggle('under-btn');\n  });\n}\n\nfunction checkTheSearchResults(searchResults) {\n  if (searchResults.length !== 0) {\n    renderFunctions.createMarkup(searchResults);\n    createModalWindows();\n  } else {\n    iziToast.show({\n      ...izitoastMessageOptions,\n      message:\n        'Sorry, there are no images matching your search query. Please try again!',\n      backgroundColor: 'red',\n    });\n  }\n}\n\nfunction isTheUserValueTheSame(userSearchParams) {\n  if (page > 1) {\n    return userValue == userSearchParams;\n  }\n}\n\nfunction createModalWindows() {\n  const galleryItem = new SimpleLightbox('.gallery a', {\n    captionSelector: 'img',\n    captionsData: 'alt',\n    captionDelay: 250,\n  });\n\n  galleryItem.on('show.simplelightbox');\n  galleryItem.refresh();\n}\n"],"names":["ImagesAPI","userSearchRequest","page","axios","error","gallery","templateImage","image","createMarkup","images","markup","markupRender","izitoastMessageOptions","refs","fetchOnPixabayAPI","loadMoreImages","userValue","isTheSame","evt","userSearchWords","userSearchParams","iziToast","isTheUserValueTheSame","imagesApi","respData","checkTheSearchResults","checkQuantityOfElements","totalQuantity","pagesQuantity","searchResults","renderFunctions.createMarkup","createModalWindows","galleryItem","SimpleLightbox"],"mappings":"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"}