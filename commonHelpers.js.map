{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["'use strict';\n\nimport axios from 'axios';\nexport class ImagesAPI {\n  constructor(userSearchRequest, page) {\n    this.BASE_URL = 'https://pixabay.com';\n    this.ENDPOINT = '/api/';\n    this.PARAMS = {\n      key: '42471766-4e6ef41ee0191e88bcacb27c7',\n      q: userSearchRequest,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: 'true',\n      page: page,\n      per_page: 15,\n    };\n\n    this.URL = `${this.BASE_URL}${this.ENDPOINT}`;\n  }\n\n  async getImages() {\n    const response = await axios.get(this.URL, { params: this.PARAMS });\n    return response.data;\n  }\n}\n","'use strict';\n\nconst gallery = document.querySelector('.gallery');\n\nexport function templateImage(image) {\n  return `<li class=\"gallery-card\">\n  <div class=\"gallery-card-wrapper\">\n    <div class=\"thumb\">\n      <a href=\"${image.largeImageURL}\" class=\"gallery-link-image\"><img class=\"gallery-img\" src=\"${image.webformatURL}\" data-original-size=\"${image.largeImageURL}\" alt=\"${image.tags}\" /></a>\n    </div>\n    <ul class=\"statistic-list\">\n      <li class=\"statistic-item\">\n        <p class=\"statistic-name\">Likes</p>\n        <p class=\"statistic-numbers\">${image.likes}</p>\n      </li>\n      <li class=\"statistic-item\">\n        <p class=\"statistic-name\">Views</p>\n        <p class=\"statistic-numbers\">${image.views}</p>\n      </li>\n      <li class=\"statistic-item\">\n        <p class=\"statistic-name\">Comments</p>\n        <p class=\"statistic-numbers\">${image.comments}</p>\n      </li>\n      <li class=\"statistic-item\">\n        <p class=\"statistic-name\">Downloads</p>\n        <p class=\"statistic-numbers\">${image.downloads}</p>\n      </li>\n    </ul>\n  </div>\n</li>`;\n}\n\nexport function createMarkup(images) {\n  const elementMarkup = images.map(image => templateImage(image));\n  const markup = elementMarkup.join('');\n  markupRender(markup);\n}\n\nexport function markupRender(markup) {\n  gallery.insertAdjacentHTML('beforeend', markup);\n}\n\nexport function findTheHeightOfLi(){\n  const liElem = document.querySelector('ul > li')\n  const sizeLiElem = liElem.getBoundingClientRect();\n  return sizeLiElem.height;\n}\n","'use strict';\n\nimport { ImagesAPI } from './js/pixabay-api';\nimport * as renderFunctions from './js/render-functions';\n\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nimport axios from 'axios';\n\nconst izitoastMessageOptions = {\n  message: 'The search field must be filled!',\n  messageColor: 'white',\n  backgroundColor: 'red',\n  close: false,\n  position: 'topRight',\n  progressBar: false,\n  animateInside: false,\n  timeout: 3000,\n};\n\nconst refs = {\n  form: document.querySelector('.form'),\n  inputSearch: document.querySelector('[type=\"search\"]'),\n  searchButton: document.querySelector('[type=\"submit\"]'),\n  gallery: document.querySelector('.gallery'),\n  loader: document.querySelector('.loader'),\n  loadButton: document.querySelector('.btn-load-more'),\n};\n\nrefs.form.addEventListener('submit', fetchOnPixabayAPI);\nrefs.loadButton.addEventListener('click', loadMoreImages);\n\nlet page = 1;\nlet userFirstValue;\n\nasync function fetchOnPixabayAPI(evt) {\n  evt.preventDefault();\n  refs.loader.classList.remove('hidden');\n\n  const userSearchWords = refs.inputSearch.value.trim(); // валідація даних, які ввів користувач;\n  const userSearchParams = userSearchWords.split(' ').join('+'); // валідація даних, які ввів користувач;\n\n  if (userSearchWords === '') {\n    refs.loader.classList.add('hidden'); // перевірка на порожній рядок.\n    iziToast.show(izitoastMessageOptions);\n    return;\n  }\n\n  const isTheSame = isTheUserValueTheSame(userSearchParams);\n\n  if (!isTheSame) {\n    refs.loadButton.classList.add('hidden');\n    refs.gallery.innerHTML = '';\n    page = 1;\n  }\n\n  const imagesApi = new ImagesAPI(userSearchParams);\n  refs.form.reset();\n\n  try {\n    const data = await imagesApi.getImages();\n\n    checkTheSearchResults(data.hits);\n\n    if (!(data.totalHits < 15)) {\n      checkQuantityOfElements(data.totalHits, imagesApi.PARAMS.per_page);\n      return;\n    }\n\n    refs.loadButton.classList.add('hidden');\n  } catch (error) {\n    iziToast.show(\n      { ...izitoastMessageOptions, message: error.message },\n      console.log(error)\n    );\n  } finally {\n    refs.loader.classList.add('hidden');\n  }\n}\n\nfunction checkQuantityOfElements(totalQuantity, per_page) {\n  const pagesQuantity = Math.ceil(totalQuantity / per_page);\n\n  if (page < pagesQuantity) {\n    refs.loadButton.classList.remove('hidden');\n  } else {\n    refs.loadButton.classList.add('hidden');\n    iziToast.show({\n      ...izitoastMessageOptions,\n      message: `We're sorry, but you've reached the end of search results.`,\n      backgroundColor: 'blue',\n    });\n  }\n}\n\nfunction scrollThePage() {\n  const liElemHeight = renderFunctions.findTheHeightOfLi();\n  window.scrollBy(0, liElemHeight * 2);\n}\n\nasync function loadMoreImages() {\n  refs.loadButton.classList.add('hidden');\n  refs.loader.classList.remove('hidden');\n  refs.loader.classList.toggle('under-btn');\n\n  page += 1;\n\n  const imagesAPI = new ImagesAPI(userFirstValue, page);\n\n  try {\n    const data = await imagesAPI.getImages();\n\n    checkTheSearchResults(data.hits);\n    checkQuantityOfElements(data.totalHits, imagesAPI.PARAMS.per_page);\n\n    refs.loader.classList.add('hidden');\n    refs.loader.classList.toggle('under-btn');\n    scrollThePage();\n  } catch (error) {\n    iziToast.show({ ...izitoastMessageOptions, message: error.message });\n    refs.loader.classList.add('hidden');\n  }\n}\n\nfunction checkTheSearchResults(searchResults) {\n  if (searchResults.length !== 0) {\n    renderFunctions.createMarkup(searchResults);\n    createModalWindows();\n  } else {\n    iziToast.show({\n      ...izitoastMessageOptions,\n      message:\n        'Sorry, there are no images matching your search query. Please try again!',\n      backgroundColor: 'red',\n    });\n  }\n}\n\nfunction isTheUserValueTheSame(userNewValue) {\n  if (page === 1) {\n    userFirstValue = userNewValue;\n    return;\n  }\n\n  return userFirstValue == userNewValue;\n}\n\nfunction createModalWindows() {\n  const galleryItem = new SimpleLightbox('.gallery a', {\n    captionSelector: 'img',\n    captionsData: 'alt',\n    captionDelay: 250,\n  });\n\n  galleryItem.on('show.simplelightbox');\n  galleryItem.refresh();\n}\n"],"names":["ImagesAPI","userSearchRequest","page","axios","gallery","templateImage","image","createMarkup","images","markup","markupRender","findTheHeightOfLi","izitoastMessageOptions","refs","fetchOnPixabayAPI","loadMoreImages","userFirstValue","evt","userSearchWords","userSearchParams","iziToast","isTheUserValueTheSame","imagesApi","data","checkTheSearchResults","checkQuantityOfElements","error","totalQuantity","per_page","pagesQuantity","scrollThePage","liElemHeight","renderFunctions.findTheHeightOfLi","imagesAPI","searchResults","renderFunctions.createMarkup","createModalWindows","userNewValue","galleryItem","SimpleLightbox"],"mappings":"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"}